{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/information-technology/java-net-socketexception","result":{"data":{"allFile":{"edges":[]},"markdownRemark":null,"mdPrevious":null,"mdNext":null,"wpPost":{"id":"cG9zdDoxMDc=","title":"java.net.SocketException: Connection resetでハマった","content":"<h1>ーはじめにー</h1>\n<p>JavaでSSL通信を行う実装をしていて、タイトルの通り、「java.net.SocketException: Connection reset」が発生。例外情報が少なすぎて原因が全く分からず、大ハマリしました。。</p>\n<h2>【環境】</h2>\n<ul>\n<li>Java：version 1.8.0.130</li>\n<li>サーバサイドSSL/TLS：TLSv1</li>\n</ul>\n<h2>【原因】</h2>\n<p>上記環境に書いてあることがまさにそのまま原因なのですが、要はJavaとサーバサイドのSSL/TLSの使用プロトコルの差異のせいでした。</p>\n<h2>【対策】</h2>\n<ol>\n<li>サーバのSSL/TLSプロトコルを最新バージョン（TLSv1.2）にするのが理想。v1やv1.1には脆弱性が報告されているため。</li>\n<li>Java側でSSL/TLSのバージョンを明記する。Java8では、SSL/TLSのデフォルトバージョンはTLSv1.2となり、サーバが対応していなければTLSv1.1となる仕様のよう。</li>\n</ol>\n<p>ちなみに今回は&#8221;2&#8243;の対策をしました。&#8221;1&#8243;を変えてもらいたかったんですけどね、大人の事情があって色々難しい。</p>\n<p>&#8220;2&#8221;の具体的な対応としては、Javaのシステムプロパティに設定するというものです。</p>\n<p><script src=\"https://gist.github.com/nisioka/f47dcfe31f273265d3d351f740a64826.js\"></script></p>\n<p>&nbsp;</p>\n<p>補足として、明示的に異なるバージョンを指定すると、以下の通り例外が変わります。この例外メッセージならば原因特定が簡単なんですけどね。</p>\n<blockquote><p>Caused by: javax.net.ssl.SSLHandshakeException: Server chose TLSv1, but that protocol version is not enabled or not supported by the client.</p></blockquote>\n<p>&nbsp;</p>\n<h1>ー終わりにー</h1>\n<p>この例外、SSLパッケージ内の広い例外のようで、調べても関係ない事象ばかりが出てきて、調査がものすごく大変でした。前述の通り、広い例外なので、同じ例外が発生していたとしても今回の解決策とはならないかもしれませんが、一つの策として書いておきます。</p>\n<p>ご参考になれば幸いです。</p>\n<div class=\"booklink-box\" style=\"text-align: left; padding-bottom: 20px; font-size: small; zoom: 1; overflow: hidden;\">\n<div class=\"booklink-image\" style=\"float: left; margin: 0 15px 10px 0;\"><a href=\"//af.moshimo.com/af/c/click?a_id=1005417&amp;p_id=170&amp;pc_id=185&amp;pl_id=4062&amp;s_v=b5Rz2P0601xu&amp;url=http%3A%2F%2Fwww.amazon.co.jp%2Fexec%2Fobidos%2FASIN%2F4797382228\" target=\"_blank\" rel=\"noopener\"><img decoding=\"async\" style=\"border: none;\" src=\"https://images-fe.ssl-images-amazon.com/images/I/51V6l3panVL._SL160_.jpg\" /></a><img loading=\"lazy\" decoding=\"async\" style=\"border: none;\" src=\"//i.moshimo.com/af/i/impression?a_id=1005417&amp;p_id=170&amp;pc_id=185&amp;pl_id=4062\" width=\"1\" height=\"1\" /></div>\n<div class=\"booklink-info\" style=\"line-height: 120%; zoom: 1; overflow: hidden;\">\n<div class=\"booklink-name\" style=\"margin-bottom: 10px; line-height: 120%;\">\n<p><a href=\"//af.moshimo.com/af/c/click?a_id=1005417&amp;p_id=170&amp;pc_id=185&amp;pl_id=4062&amp;s_v=b5Rz2P0601xu&amp;url=http%3A%2F%2Fwww.amazon.co.jp%2Fexec%2Fobidos%2FASIN%2F4797382228\" target=\"_blank\" rel=\"noopener\">暗号技術入門 第3版</a><img loading=\"lazy\" decoding=\"async\" style=\"border: none;\" src=\"//i.moshimo.com/af/i/impression?a_id=1005417&amp;p_id=170&amp;pc_id=185&amp;pl_id=4062\" width=\"1\" height=\"1\" /></p>\n<div class=\"booklink-powered-date\" style=\"font-size: 8pt; margin-top: 5px; font-family: verdana; line-height: 120%;\">posted with <a href=\"https://yomereba.com\" target=\"_blank\" rel=\"nofollow noopener\">ヨメレバ</a></div>\n</div>\n<div class=\"booklink-detail\" style=\"margin-bottom: 5px;\">結城 浩 SBクリエイティブ 2015-08-26</div>\n<div class=\"booklink-link2\" style=\"margin-top: 10px;\">\n<div class=\"shoplinkamazon\" style=\"display: inline; margin-right: 5px;\"><a href=\"//af.moshimo.com/af/c/click?a_id=1005417&amp;p_id=170&amp;pc_id=185&amp;pl_id=4062&amp;s_v=b5Rz2P0601xu&amp;url=http%3A%2F%2Fwww.amazon.co.jp%2Fexec%2Fobidos%2FASIN%2F4797382228\" target=\"_blank\" rel=\"noopener\">Amazon</a><img loading=\"lazy\" decoding=\"async\" style=\"border: none;\" src=\"//i.moshimo.com/af/i/impression?a_id=1005417&amp;p_id=170&amp;pc_id=185&amp;pl_id=4062\" width=\"1\" height=\"1\" /></div>\n<div class=\"shoplinkkindle\" style=\"display: inline; margin-right: 5px;\"><a href=\"//af.moshimo.com/af/c/click?a_id=1005417&amp;p_id=170&amp;pc_id=185&amp;pl_id=4062&amp;s_v=b5Rz2P0601xu&amp;url=http%3A%2F%2Fwww.amazon.co.jp%2Fexec%2Fobidos%2FASIN%2FB015643CPE%2F\" target=\"_blank\" rel=\"noopener\">Kindle</a><img loading=\"lazy\" decoding=\"async\" style=\"border: none;\" src=\"//i.moshimo.com/af/i/impression?a_id=1005417&amp;p_id=170&amp;pc_id=185&amp;pl_id=4062\" width=\"1\" height=\"1\" /></div>\n<div class=\"shoplinkrakuten\" style=\"display: inline; margin-right: 5px;\"><a href=\"//af.moshimo.com/af/c/click?a_id=1005417&amp;p_id=56&amp;pc_id=56&amp;pl_id=637&amp;s_v=b5Rz2P0601xu&amp;url=http%3A%2F%2Fbooks.rakuten.co.jp%2Frb%2F13306240%2F\" target=\"_blank\" rel=\"noopener\">楽天ブックス</a><img loading=\"lazy\" decoding=\"async\" style=\"border: none;\" src=\"//i.moshimo.com/af/i/impression?a_id=1005417&amp;p_id=170&amp;pc_id=185&amp;pl_id=4062\" width=\"1\" height=\"1\" /></div>\n<div class=\"shoplinkrakukobo\" style=\"display: inline; margin-right: 5px;\"><a href=\"//af.moshimo.com/af/c/click?a_id=1005417&amp;p_id=56&amp;pc_id=56&amp;pl_id=637&amp;s_v=b5Rz2P0601xu&amp;url=https%3A%2F%2Fbooks.rakuten.co.jp%2Frk%2F6f0fba9609d4323486d7d4a7d8050482\" target=\"_blank\" rel=\"noopener\">楽天kobo</a><img loading=\"lazy\" decoding=\"async\" style=\"border: none;\" src=\"//i.moshimo.com/af/i/impression?a_id=1005417&amp;p_id=56&amp;pc_id=56&amp;pl_id=637\" width=\"1\" height=\"1\" /></div>\n</div>\n</div>\n<div class=\"booklink-footer\" style=\"clear: left;\"></div>\n</div>\n","excerpt":"<p>ーはじめにー JavaでSSL通信を行う実装をしていて、タイトルの通り、「java.net.SocketException: Connection reset」が発生。例外情報が少なすぎて原因が全く分からず、大ハマリしま [&hellip;]</p>\n","slug":"java-net-socketexception","date":"2017/10/30","modified":"2018/08/02","featuredImage":{"node":{"altText":"","gatsbyImage":{"images":{"sources":[{"srcSet":"/_gatsby/image/8b16eedd708f61d16753c9ef8162c509/9a4825e155d2872d519eab5b88ddb375/Cheap_SSL_Shop.avif?u=http%3A%2F%2Flocalhost%2Fwp-content%2Fuploads%2F2017%2F10%2FCheap_SSL_Shop.png&a=w%3D80%26h%3D80%26fm%3Davif%26q%3D75&cd=16f45013d894f09a9c731ef3e7dca6fb 80w,/_gatsby/image/8b16eedd708f61d16753c9ef8162c509/43792de743fd5bc0d91aacb4cd9248ae/Cheap_SSL_Shop.avif?u=http%3A%2F%2Flocalhost%2Fwp-content%2Fuploads%2F2017%2F10%2FCheap_SSL_Shop.png&a=w%3D160%26h%3D160%26fm%3Davif%26q%3D75&cd=16f45013d894f09a9c731ef3e7dca6fb 160w,/_gatsby/image/8b16eedd708f61d16753c9ef8162c509/dec15694502a7d5b66ff9f59071a2d81/Cheap_SSL_Shop.avif?u=http%3A%2F%2Flocalhost%2Fwp-content%2Fuploads%2F2017%2F10%2FCheap_SSL_Shop.png&a=w%3D320%26h%3D320%26fm%3Davif%26q%3D75&cd=16f45013d894f09a9c731ef3e7dca6fb 320w","type":"image/avif","sizes":"(min-width: 320px) 320px, 100vw"},{"srcSet":"/_gatsby/image/8b16eedd708f61d16753c9ef8162c509/e1cb8e392ab57f84e8715e8f280139e9/Cheap_SSL_Shop.webp?u=http%3A%2F%2Flocalhost%2Fwp-content%2Fuploads%2F2017%2F10%2FCheap_SSL_Shop.png&a=w%3D80%26h%3D80%26fm%3Dwebp%26q%3D75&cd=16f45013d894f09a9c731ef3e7dca6fb 80w,/_gatsby/image/8b16eedd708f61d16753c9ef8162c509/c422829a9b1207f3db3ab3c82a7de728/Cheap_SSL_Shop.webp?u=http%3A%2F%2Flocalhost%2Fwp-content%2Fuploads%2F2017%2F10%2FCheap_SSL_Shop.png&a=w%3D160%26h%3D160%26fm%3Dwebp%26q%3D75&cd=16f45013d894f09a9c731ef3e7dca6fb 160w,/_gatsby/image/8b16eedd708f61d16753c9ef8162c509/a05606add6dbd1281d5d4145c1de3869/Cheap_SSL_Shop.webp?u=http%3A%2F%2Flocalhost%2Fwp-content%2Fuploads%2F2017%2F10%2FCheap_SSL_Shop.png&a=w%3D320%26h%3D320%26fm%3Dwebp%26q%3D75&cd=16f45013d894f09a9c731ef3e7dca6fb 320w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}],"fallback":{"src":"/_gatsby/image/8b16eedd708f61d16753c9ef8162c509/7b298770dfbac979ea07f70a796f8b80/Cheap_SSL_Shop.png?u=http%3A%2F%2Flocalhost%2Fwp-content%2Fuploads%2F2017%2F10%2FCheap_SSL_Shop.png&a=w%3D80%26h%3D80%26fm%3Dpng%26q%3D75&cd=16f45013d894f09a9c731ef3e7dca6fb","srcSet":"/_gatsby/image/8b16eedd708f61d16753c9ef8162c509/7b298770dfbac979ea07f70a796f8b80/Cheap_SSL_Shop.png?u=http%3A%2F%2Flocalhost%2Fwp-content%2Fuploads%2F2017%2F10%2FCheap_SSL_Shop.png&a=w%3D80%26h%3D80%26fm%3Dpng%26q%3D75&cd=16f45013d894f09a9c731ef3e7dca6fb 80w,/_gatsby/image/8b16eedd708f61d16753c9ef8162c509/c359e0cc01269d2c63f27c71ca9207bf/Cheap_SSL_Shop.png?u=http%3A%2F%2Flocalhost%2Fwp-content%2Fuploads%2F2017%2F10%2FCheap_SSL_Shop.png&a=w%3D160%26h%3D160%26fm%3Dpng%26q%3D75&cd=16f45013d894f09a9c731ef3e7dca6fb 160w,/_gatsby/image/8b16eedd708f61d16753c9ef8162c509/e680dcc70730e97e1b463f4c76a3a5d8/Cheap_SSL_Shop.png?u=http%3A%2F%2Flocalhost%2Fwp-content%2Fuploads%2F2017%2F10%2FCheap_SSL_Shop.png&a=w%3D320%26h%3D320%26fm%3Dpng%26q%3D75&cd=16f45013d894f09a9c731ef3e7dca6fb 320w","sizes":"(min-width: 320px) 320px, 100vw"}},"layout":"constrained","width":320,"height":320,"backgroundColor":"rgb(248,248,248)"}}},"categories":{"nodes":[{"name":"技術"}]},"tags":{"nodes":[{"name":"Java"},{"name":"SSL"},{"name":"TLS"}]}},"wpPrevious":{"title":"公式主催のGitHub Enterprise企業導入セミナーに行ってきた","slug":"github-enterprise","categories":{"nodes":[{"name":"イベントレポート"}]}},"wpNext":{"title":"中の人に聞く、Java10のvar記法の使い方について","slug":"jjug-java10-var","categories":{"nodes":[{"name":"イベントレポート"}]}}},"pageContext":{"id":"cG9zdDoxMDc=","previousPostId":"cG9zdDoxMTY=","nextPostId":"cG9zdDoxMjk=","imagePath":null}},"staticQueryHashes":["2488138200","3280520893"],"slicesMap":{}}