{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/life/7pay-unauthorized-access","result":{"data":{"blogImage":{"edges":[]},"oldBlogImage":{"edges":[]},"markdownRemark":{"id":"ccbef82f-a807-589f-b9e5-687d38897a8d","excerpt":"大きな話題となりました、セブンイレブンが発行しているアプリの7payに不正アクセスがあった件です。 https://www.sej.co.jp/company/important/20190703.html…","html":"<p>大きな話題となりました、セブンイレブンが発行しているアプリの7payに不正アクセスがあった件です。</p>\n<p><a href=\"https://www.sej.co.jp/company/important/20190703.html\"></a><a href=\"https://www.sej.co.jp/company/important/20190703.html\">https://www.sej.co.jp/company/important/20190703.html</a></p>\n<p>この記事では情報セキュリティスペシャリスト資格を持つ私がこの一連の事件を解説しようと思います。詳細はまだ公表されていないのでどういった不備がいくつあったのかは分かりませんが、私の知り得た情報での説明をしてみます。</p>\n<p>ちなみに情報セキュリティスペシャリストとは、情報処理推進機構(IPA)が発行する、こうしたアプリケーションやWebサイトなどの情報セキュリティの知識を有することを示す国家資格です。</p>\n<p><a href=\"https://www.jitec.ipa.go.jp/1_11seido/sc_28.html\">https://www.jitec.ipa.go.jp/1_11seido/sc_28.html</a></p>\n<p>と、偉そうに名乗りましたが、今回説明するのはかなり単純な不正アクセスで、技術的に難しいことは何もないです。<strong>特別なものは何一つ必要なく誰でも出来てしまう</strong>やらかしとなります。</p>\n<h2>何がいけなかったのか？</h2>\n<p>今回の一番の原因は、パスワードリセット機能での仕様不備です。その機能では、①本人確認が甘かったことと、②任意のメールアドレスにリセット用のメールが送れてしまうこととが良くないところでした。</p>\n<p>これにより、攻撃者は本人確認を<strong>推察(要は当てずっぽう)<strong>して、攻撃者のメールアドレスに対して</strong>他人のアカウントの</strong>パスワードリセットメールを送らせて、パスワードを変更しアカウントを乗っ取ります。</p>\n<h3>脆弱性① 本人確認が甘かった</h3>\n<p>パスワードリセットメールを送るには、画面で本人情報を入力します。ここで入力の必要があるのは以下の項目です。</p>\n<ul>\n<li>生年月日</li>\n<li>7id(メールアドレス)</li>\n<li>画像認証</li>\n<li>送付先メールアドレス</li>\n</ul>\n<p>ここで、画像認証とはよくあるロボットでは無いことを確認する崩した文字列の画像のことで、送付先メールアドレスは任意のアドレスを受け付けます。なのでこれらは人間であれば誰でも入力可能な値です。</p>\n<p>従って、本人確認の情報としては生年月日とメールアドレスです。これら２つを知っているのは本当に本人だけでしょうか？</p>\n<p>生年月日をSNSなどに公開していたり、メールアドレスもメールのやり取りをしたことがあれば知っているはずです。まず、こうしたソーシャルハッキングとして知人のこうした情報を知っているだけでアカウント乗っ取りが可能です。</p>\n<p>また、もう一つまずいこととしては、アプリの会員登録時に生年月日を入力しなかった場合は「2019/1/1」に固定されてしまう仕様があることです。なので、誕生日が分からなくても、登録されていない可能性を考えてこの日付を入れれば一定の割合で合致してしまいます。</p>\n<h3>脆弱性② 任意のメールアドレスにリセット用のメールが送れてしまう</h3>\n<p>こうしたパスワードリセットの際に送るメールは既に登録してあるメールアドレスに送るのが定石です。</p>\n<p>これが守られていれば、本人のメールアドレスに対してリセットメールが送られるので、攻撃者はメールのアカウントも乗っ取れていなければなりません。なので攻撃成功のハードルがグッと下がってしまっている仕様でした。</p>\n<h3>攻撃方法</h3>\n<p>これらの脆弱性を用いて、攻撃者はどのように不正アクセスをしたのかを推測すると、</p>\n<p>有効であるメールアドレスを集めて、セブンイレブンアプリのパスワードリセット画面にそのメールアドレスと生年月日「2019/1/1」を入力するのをひたすらに試していったというところでしょうか。</p>\n<p>結構成功確率が低そうに思えますが、手動でも10秒くらいで試行できますし、画像認証だけうまくすればスクリプトを組んで半自動でも出来そうです。</p>\n<h2>ユーザ側に防御策はあったか？</h2>\n<p>多くの場合、厳格なパスワード管理をすることが基本です。しかし、今回の場合はパスワードリセットを使って攻撃されたので意味はありませんでした。ただ、それでも自衛のために出来ることはあります。</p>\n<h3>メールアドレスの工夫</h3>\n<p>公開、使用しているメールアドレスとは別に、こうしたアカウント登録用のメールアドレスを用意すると良いです。GmailやYahoo!メールなど、フリーのメールは今や簡単に作れます。</p>\n<p>また、それだとメールアドレスを複数管理しなくてはならなくて面倒だという場合、エイリアスという機能が使えます。これは、仮に<a href=\"mailto:sample@gmail.com\">sample@gmail.com</a>というGmailアドレスがあったときに、@の前に+○○と付与することで、別のメールアドレスでありながら同一アカウントで受け取れます。Yahoo!メールにもセーフティアドレスという同様の機能があります。</p>\n<h2>今回の事件について思うこと</h2>\n<p>正直、今回の件はセブンイレブン側のセキュリティの意識が甘すぎたと思います。決済のサービスは、何か不備があればすぐに顧客の不利益となるので、特に細心の注意を払うべきでした。</p>\n<p>肩を持つようですが、セキュリティに対する対策は「出来ていて当たり前」で、誉められることはなく出来てなければ大問題となり、モチベーションが上がることはない所です。ただそれでも怠ってはいけない所でした。</p>\n<p>しかし、今回のことで、○○ペイは危ないなどの、無駄に主語を広げた捉え方は避けてほしいです。セブンイレブンの対応が不味かっただけで、こうした決済手段が増えること自体は良いことです。</p>\n<p>また、パスワードリセットはパスワードが分からなくても認証できてしまうという、そもそもセキュリティハードルを下げる操作であるので、セキュリティを一定程度保ちつつ、ユーザの利便性を損なわないようにするには、絶妙のラインとなるようにしなければなりません。セキュリティ的にとても難しいのです。ですので、皆様におかれましては、仮にパスワードリセット手順が面倒でも、セキュリティ担保のために致し方ないことをご理解ください。また、一番は忘れないようにしっかりとした管理をしましょう。</p>","fields":{"slug":"/posts/7pay-unauthorized-access/"},"frontmatter":{"title":"7payの不正アクセスについてセキュリティスペシャリストが解説","date":"2019/07/20","dateModified":null,"description":null,"category":null,"categories":["life"],"tags":["7pay","決済"]}},"mdPrevious":{"fields":{"slug":"/migrate-from-wordpress/"},"frontmatter":{"title":"AWSにデプロイしていたWordPressサイトをGatsbyJSによるGitHub Pagesでの静的サイトへ移行","category":"技術","categories":null}},"mdNext":{"fields":{"slug":"/posts/2018-03-26-jjug-night-seminar/"},"frontmatter":{"title":"JJUG ナイトセミナー 「Java SE 10 / JDK10リリース特集」に行ってきた 【2018/3/26】","category":null,"categories":["event-report"]}}},"pageContext":{"id":"ccbef82f-a807-589f-b9e5-687d38897a8d","previousPostId":"a5dcd15f-94ff-595b-90cf-25b5ecb7a059","nextPostId":"97cd7205-c218-502a-87b7-4dcb7f0ea4a0","imagePath":"posts\\7pay-unauthorized-access\\images\\7.jpeg"}},"staticQueryHashes":["3695098706","798193786"],"slicesMap":{}}